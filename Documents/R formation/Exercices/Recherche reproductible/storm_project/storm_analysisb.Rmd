---
title: "Impact of Severe Weather Events on Public Health and Economy in the U.S."
author: "Bertrand"
date: "2026-01-16"
output: html_document
---

## Synopsis

Severe weather events can cause substantial harm to communities, including injuries and fatalities as well as extensive property and crop damage.  
This report analyzes the U.S. National Oceanic and Atmospheric Administration (NOAA) Storm Data database (1950–November 2011) to identify which event types have the greatest public health impacts and which have the greatest economic consequences.  
Public health impact is assessed using the total number of fatalities and injuries, aggregated by event type.  
Economic impact is assessed using total property and crop damages, converted to U.S. dollars based on the recorded magnitude exponents (e.g., K, M, B).  
To improve comparability, event types are standardized by trimming whitespace and converting to uppercase.  
Results are presented as top summaries and two bar plots to support prioritization of preparedness resources.  
Overall, the analysis highlights a small number of event categories that dominate health impacts and a partly different set of categories that dominate economic losses.  
All transformations and results are reproducible directly from the raw compressed CSV file.

---

## Data Processing

```{r setup, echo=TRUE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Packages (install if missing)
pkgs <- c("dplyr", "ggplot2", "scales", "knitr")
for (p in pkgs) {
  if (!requireNamespace(p, quietly = TRUE)) install.packages(p, repos = "https://cloud.r-project.org")
}

library(dplyr)
library(ggplot2)
library(scales)
library(knitr)
# Load the raw data

file <- "repdata_data_StormData.csv.bz2"
storm <- read.csv(file, stringsAsFactors = FALSE)

dim(storm)
names(storm)[1:15]
# Keep required variables and standardize EVTYPE

data <- storm %>%
select(EVTYPE, FATALITIES, INJURIES, PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP) %>%
mutate(EVTYPE = toupper(trimws(EVTYPE)))

summary(data$FATALITIES)
summary(data$INJURIES)
#Convert damage exponents to dollars

exp_map <- function(x) {
x <- toupper(trimws(x))
dplyr::case_when(
x == "H" ~ 1e2,
x == "K" ~ 1e3,
x == "M" ~ 1e6,
x == "B" ~ 1e9,
x == ""  ~ 1,
x == "0" ~ 1,
x == "1" ~ 10,
x == "2" ~ 1e2,
x == "3" ~ 1e3,
x == "4" ~ 1e4,
x == "5" ~ 1e5,
x == "6" ~ 1e6,
x == "7" ~ 1e7,
x == "8" ~ 1e8,
x == "9" ~ 1e9,
TRUE ~ NA_real_
)
}

data <- data %>%
mutate(
prop_mult   = exp_map(PROPDMGEXP),
crop_mult   = exp_map(CROPDMGEXP),
prop_damage = PROPDMG * prop_mult,
crop_damage = CROPDMG * crop_mult,
econ_damage = prop_damage + crop_damage
)

# Quick diagnostics (unexpected exponent codes)

sum(is.na(data$prop_mult))
sum(is.na(data$crop_mult))
exp_map <- function(x) {
x <- toupper(trimws(x))
dplyr::case_when(
x == "H" ~ 1e2,
x == "K" ~ 1e3,
x == "M" ~ 1e6,
x == "B" ~ 1e9,
x == ""  ~ 1,
x == "0" ~ 1,
x == "1" ~ 10,
x == "2" ~ 1e2,
x == "3" ~ 1e3,
x == "4" ~ 1e4,
x == "5" ~ 1e5,
x == "6" ~ 1e6,
x == "7" ~ 1e7,
x == "8" ~ 1e8,
x == "9" ~ 1e9,
TRUE ~ NA_real_
)
}
data <- data %>%
mutate(
prop_mult   = exp_map(PROPDMGEXP),
crop_mult   = exp_map(CROPDMGEXP),
prop_damage = PROPDMG * prop_mult,
crop_damage = CROPDMG * crop_mult,
econ_damage = prop_damage + crop_damage
)

# Quick diagnostics (unexpected exponent codes)

sum(is.na(data$prop_mult))
sum(is.na(data$crop_mult))

## Results


#Public health impacts (fatalities + injuries)

health <- data %>%
group_by(EVTYPE) %>%
summarise(
fatalities   = sum(FATALITIES, na.rm = TRUE),
injuries     = sum(INJURIES, na.rm = TRUE),
total_health = fatalities + injuries,
.groups = "drop"
) %>%
arrange(desc(total_health))

top_health <- health %>% slice_head(n = 10)

kable(top_health, caption = "Top 10 Event Types by Public Health Impact (Fatalities + Injuries)")
ggplot(top_health, aes(x = reorder(EVTYPE, total_health), y = total_health)) +
geom_col() +
coord_flip() +
labs(
title = "Top 10 Weather Event Types Most Harmful to Population Health",
subtitle = "Measured as total fatalities + injuries (NOAA Storm Data, 1950–Nov 2011)",
x = "Event type (EVTYPE)",
y = "Total fatalities + injuries"
)
# Economic impacts (property + crop damage)

econ <- data %>%
group_by(EVTYPE) %>%
summarise(
property_damage = sum(prop_damage, na.rm = TRUE),
crop_damage     = sum(crop_damage, na.rm = TRUE),
total_econ      = sum(econ_damage, na.rm = TRUE),
.groups = "drop"
) %>%
arrange(desc(total_econ))

top_econ <- econ %>% slice_head(n = 10)

kable(top_econ, caption = "Top 10 Event Types by Total Economic Damage (Property + Crops, USD)")
ggplot(top_econ, aes(x = reorder(EVTYPE, total_econ), y = total_econ)) +
geom_col() +
coord_flip() +
scale_y_continuous(labels = label_dollar(scale = 1e-9, suffix = "B")) +
labs(
title = "Top 10 Weather Event Types with Greatest Economic Consequences",
subtitle = "Total property + crop damage converted to USD (NOAA Storm Data, 1950–Nov 2011)",
x = "Event type (EVTYPE)",
y = "Total economic damage (Billions of USD)"
)

# Decision-maker interpretation (Top 1–3) + prioritization statement

## Helper formatters

fmt_int <- function(x) format(round(x), big.mark = ",")
fmt_usd <- function(x) paste0("$", format(round(x), big.mark = ","))

h3 <- health %>% slice_head(n = 3)
e3 <- econ   %>% slice_head(n = 3)

health_paragraph <- paste0(
"Public health impacts are dominated by ", h3$EVTYPE[1],
", followed by ", h3$EVTYPE[2], " and ", h3$EVTYPE[3], ". ",
"Over 1950–Nov 2011, ", h3$EVTYPE[1], " accounts for ",
fmt_int(h3$fatalities[1]), " fatalities and ", fmt_int(h3$injuries[1]),
" injuries (total ", fmt_int(h3$total_health[1]), "). ",
"The next two event types total ", fmt_int(h3$total_health[2]),
" and ", fmt_int(h3$total_health[3]), " affected people, respectively."
)

econ_paragraph <- paste0(
"Economic losses are dominated by ", e3$EVTYPE[1],
", followed by ", e3$EVTYPE[2], " and ", e3$EVTYPE[3], ". ",
"Total damage (property + crops) is estimated at ", fmt_usd(e3$total_econ[1]),
" for ", e3$EVTYPE[1], " (property: ", fmt_usd(e3$property_damage[1]),
"; crops: ", fmt_usd(e3$crop_damage[1]), "). ",
"The next two event types are associated with ", fmt_usd(e3$total_econ[2]),
" and ", fmt_usd(e3$total_econ[3]), " in total losses, respectively."
)

priority_sentence <- paste0(
"Prioritization should recognize that the leading event types for human harm and for financial loss are not always identical; ",
"preparedness planning should balance life-safety interventions with mitigation strategies that reduce high-cost damages."
)

health_paragraph
econ_paragraph
priority_sentence

## Candidate list: union of top 10 health and top 10 economic event types

candidate_evtypes <- union(top_health$EVTYPE, top_econ$EVTYPE)

# Add ranks

health_ranked <- health %>%
mutate(health_rank = row_number())

econ_ranked <- econ %>%
mutate(econ_rank = row_number())

# Build decision table

decision <- tibble(EVTYPE = candidate_evtypes) %>%
left_join(health_ranked %>% select(EVTYPE, health_rank, fatalities, injuries, total_health),
by = "EVTYPE") %>%
left_join(econ_ranked %>% select(EVTYPE, econ_rank, property_damage, crop_damage, total_econ),
by = "EVTYPE") %>%
mutate(
# Replace missing ranks with large number (not in the list)
health_rank = ifelse(is.na(health_rank), 9999, health_rank),
econ_rank   = ifelse(is.na(econ_rank),   9999, econ_rank),


# Normalize impacts to 0–100 among candidates (use total_health and total_econ)
health_score_0_100 = 100 * (total_health - min(total_health, na.rm = TRUE)) /
  (max(total_health, na.rm = TRUE) - min(total_health, na.rm = TRUE)),

econ_score_0_100 = 100 * (total_econ - min(total_econ, na.rm = TRUE)) /
  (max(total_econ, na.rm = TRUE) - min(total_econ, na.rm = TRUE))


)

# If some candidates have NA totals (rare), set scores to 0 for display stability

decision <- decision %>%
mutate(
health_score_0_100 = ifelse(is.na(health_score_0_100), 0, health_score_0_100),
econ_score_0_100   = ifelse(is.na(econ_score_0_100), 0, econ_score_0_100)
)

# Choose weights for a combined priority score (adjustable)

w_health <- 0.5
w_econ   <- 0.5

decision <- decision %>%
mutate(
combined_priority_score = w_health * health_score_0_100 + w_econ * econ_score_0_100
) %>%
arrange(desc(combined_priority_score)) %>%
mutate(
# Format for display
total_econ_fmt = fmt_usd(total_econ),
property_fmt   = fmt_usd(property_damage),
crop_fmt       = fmt_usd(crop_damage)
) %>%
select(
EVTYPE,
health_rank, total_health, fatalities, injuries, health_score_0_100,
econ_rank, total_econ_fmt, property_fmt, crop_fmt, econ_score_0_100,
combined_priority_score
)

kable(decision,
digits = 1,
caption = "Decision Table: Comparing Health and Economic Impacts (Union of Top-10 Lists; Scores normalized to 0–100)")
```